<div class="bg-white rounded-lg shadow-md p-6">
  <div class="mb-6">
    <%= link_to "← Back to Resumes", resumes_path, class: "text-blue-600 hover:underline" %>
  </div>
  
  <div class="mb-8">
    <h1 class="text-3xl font-bold mb-2"><%= @resume.filename %></h1>
    <p class="text-sm text-gray-500">
      Uploaded <%= time_ago_in_words(@resume.created_at) %> ago
    </p>
  </div>
  
  <% if @resume.summary.present? %>
    <div class="mb-8 bg-blue-50 rounded-lg p-4">
      <h2 class="text-xl font-semibold mb-2">Summary</h2>
      <p class="text-gray-700"><%= @resume.summary %></p>
    </div>
  <% end %>
  
  <div class="mb-8">
    <h2 class="text-2xl font-semibold mb-4">Extracted Skills</h2>
    
    <% if @resume.extracted_skills.any? %>
      <div class="flex flex-wrap gap-2">
        <% @resume.extracted_skills.each do |skill| %>
          <span class="bg-green-100 text-green-800 px-3 py-2 rounded-lg">
            <%= skill %>
          </span>
        <% end %>
      </div>
    <% else %>
      <p class="text-gray-500">
        Skills are being extracted... This may take a moment.
      </p>
      <button onclick="location.reload()" class="mt-3 text-blue-600 hover:underline">
        Refresh to see results
      </button>
    <% end %>
  </div>
  
  <!-- Find Matches -->
  <div class="mb-8 bg-yellow-50 rounded-lg p-6">
    <h2 class="text-2xl font-semibold mb-4">Find Job Matches</h2>
    <p class="text-gray-700 mb-4">
      Match your resume against available jobs to see how well you fit!
    </p>
    
    <%= form_with url: matches_path, method: :post, class: "space-y-4" do |f| %>
      <%= hidden_field_tag 'resume_id', @resume.id %>
      
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Select a Job</label>
        <%= select_tag 'job_id', options_from_collection_for_select(Job.active.recent, 'id', 'title'), { include_blank: 'Choose a job...' }, class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" %>
      </div>
      
      <%= submit_tag "Create Match", class: "bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 cursor-pointer" %>
    <% end %>
  </div>
  
  <!-- Existing Matches -->
  <% if @matches.any? %>
    <div class="mb-8">
      <h2 class="text-2xl font-semibold mb-4">Your Matches</h2>
      
      <div class="space-y-4">
        <% @matches.each do |match| %>
          <%= link_to match_path(match), class: "block" do %>
            <div class="border rounded-lg p-4 hover:shadow-lg transition">
              <div class="flex justify-between items-center">
                <div class="flex-1">
                  <h3 class="text-lg font-semibold text-gray-900 mb-1">
                    <%= match.job.title %>
                  </h3>
                  <p class="text-gray-600 mb-2"><%= match.job.company %></p>
                  
                  <div class="flex items-center space-x-4 text-sm">
                    <span class="text-green-600">
                      ✓ <%= match.matched_skills.size %> matched skills
                    </span>
                    <% if match.missing_skills.any? %>
                      <span class="text-yellow-600">
                        ⚠ <%= match.missing_skills.size %> missing skills
                      </span>
                    <% end %>
                  </div>
                </div>
                
                <div class="text-right ml-4">
                  <p class="text-4xl font-bold text-<%= match.score >= 70 ? 'green' : match.score >= 50 ? 'yellow' : 'red' %>-600">
                    <%= match.match_percentage %>
                  </p>
                  <p class="text-sm text-gray-600"><%= match.match_level %></p>
                </div>
              </div>
            </div>
          <% end %>
        <% end %>
      </div>
    </div>
  <% end %>
  
  <div class="flex space-x-3">
    <%= link_to "Delete Resume", resume_path(@resume), method: :delete, data: { confirm: "Are you sure?" }, class: "bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700" %>
  </div>
</div>
